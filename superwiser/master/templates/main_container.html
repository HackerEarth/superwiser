<div>
    <div>
        <h4>Process List</h4>
    </div>
    <div class="col-lg-12 col-md-12 col-sm-12">
        <table class="table table-striped table-hover " id="process-table">
            <thead>
                <tr>
                    <th>Process</th>
                    <th>Nodes</th>
                    <th>Process Count</th>
                    <th>State</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
            {% for proc in all_procs %}
                <tr>
                    <td title="{{ proc.command }}">{{ proc.name }}</td>
                    <td>
                    {% for node in proc.nodes %}
                        <a href="http://{{ node.node_ip }}:9001/" target="_blank">{{ node.name }}</a>
                    {% endfor %}
                    </td>
                    <td>{{ proc.numprocs }}</td>
                    <td>
                        {% if proc.running %}
                        <i id="green" class="fa fa-circle" aria-hidden="true"></i>
                        {% else %}
                        <i id="red" class="fa fa-circle" aria-hidden="true"></i>
                        {% endif %}
                    </td>
                    <td>
                        {% if proc.running %}
                        <a class="action" type="stop" program="{{ proc.name }}">stop</a>
                        {% else %}
                        <a class="action" type="start"program="{{ proc.name }}">start</a>
                        {% endif %}

                        <a class="action" type="restart" program="{{ proc.name }}">restart</a>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
    
    <div id="node-container" class="col-lg-3 col-md-3 col-sm-12">
        <ul class="list-group">
            {% for node in all_nodes %}
            <li class="list-group-item">
            <a href="http://{{ node.node_ip }}:9001/" target="_blank">{{ node.name }}</a>
            </li>
            {% endfor %}
        </ul>
    </div>
</div>

<script type="text/javascript">
$( document ).ready(function() {
    console.log( "ready!" );
    $(".action").on("click", function(e){
        console.log('Gowda here!');
        $(this).removeClass('action');
        $(this).addClass('disable');
        action = this.getAttribute('type');
        proc = this.getAttribute('program');
        console.log("Clicked" + action + proc);
        master = window.location.host
        url = "http://" + master + "/api/"
        params = {
            "action": action,
            "program": proc
        }
        $.ajax({
            'type': "POST",
            'url': url,
            'data': params,
            'success': function(data){
                location.reload();
            },
        });                           
    });
});
</script>
